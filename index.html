
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="theme-color" content="#3b82f6" />
    <meta name="description" content="Professional financial management tool for tracking cash flow and commissions.">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2755/2755444.png">
    <title>FinTrack Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class', // Enable dark mode
        theme: {
          extend: {
            colors: {
              primary: {
                '50': '#eff6ff', '100': '#dbeafe', '200': '#bfdbfe', '300': '#93c5fd', '400': '#60a5fa', '500': '#3b82f6', '600': '#2563eb', '700': '#1d4ed8', '800': '#1e40af', '900': '#1e3a8a', '950': '#172554'
              }
            },
            padding: {
              'safe-bottom': 'env(safe-area-inset-bottom)'
            },
            animation: {
                'input-glow': 'pulse-shadow 1.5s infinite',
                'breathing-green': 'breathing-green 2s infinite',
                'progress': 'progress-indeterminate 2s infinite linear',
            },
            keyframes: {
                'pulse-shadow': {
                    '0%, 100%': { boxShadow: '0 0 0 2px currentColor, 0 0 8px currentColor' },
                    '50%': { boxShadow: '0 0 0 2px currentColor, 0 0 12px currentColor' },
                },
                'breathing-green': {
                    '0%, 100%': { boxShadow: '0 0 0 2px #4ade80, 0 0 4px rgba(74, 222, 128, 0.4)', borderColor: '#4ade80' },
                    '50%': { boxShadow: '0 0 0 4px #4ade80, 0 0 10px rgba(74, 222, 128, 0.6)', borderColor: '#22c55e' },
                },
                'progress-indeterminate': {
                    '0%': { transform: 'translateX(-100%)', width: '20%' },
                    '50%': { transform: 'translateX(50%)', width: '60%' },
                    '100%': { transform: 'translateX(200%)', width: '20%' }
                }
            }
          }
        }
      }
    </script>
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
    /* Ensure date input text is readable and picker is usable */
    input[type="date"] {
        color-scheme: light;
    }
    .dark input[type="date"] {
        color-scheme: dark;
    }
    /* Fix for webkit-based browsers' calendar icon in dark mode */
    .dark input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
    }

    /* --- GLOBAL ANIMATIONS --- */
    
    /* Keyframes */
    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fade-in-up {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fade-in-scale-up {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
    }
    @keyframes pulse-red-border {
      0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
      50% { box-shadow: 0 0 0 6px rgba(239, 68, 68, 0); }
    }

    /* Robust Breathing Glow for Input Fields */
    @keyframes breathing-glow {
        0% { box-shadow: 0 0 0 3px rgba(74, 222, 128, 0.4); border-color: #4ade80; }
        50% { box-shadow: 0 0 0 6px rgba(74, 222, 128, 0.1); border-color: #22c55e; }
        100% { box-shadow: 0 0 0 3px rgba(74, 222, 128, 0.4); border-color: #4ade80; }
    }
    .breathing-glow {
        animation: breathing-glow 2s infinite !important;
        z-index: 10;
        position: relative;
    }

    /* Animation Classes */
    .animate-fade-in { animation: fade-in 0.3s ease-out forwards; }
    .animate-fade-in-up { animation: fade-in-up 0.5s ease-out forwards; }
    .animate-fade-in-scale-up { animation: fade-in-scale-up 0.3s ease-out forwards; }
    .animate-pulse-border { animation: pulse-red-border 2.5s infinite cubic-bezier(0.66, 0, 0, 1); }
    
    /* Staggered list animation */
    .stagger-child {
      opacity: 0;
      animation: fade-in-up 0.6s ease-out forwards;
    }

    /* --- GLOBAL TRANSITIONS --- */
    
    /* General interactive elements */
    button, .interactive-card {
        transition: all 0.2s ease-out;
    }
    
    button:hover, .interactive-card:hover {
        transform: translateY(-2px);
    }
    
    button:active, .interactive-card:active {
        transform: translateY(-1px) scale(0.98);
        filter: brightness(0.95);
    }

    .interactive-card:hover {
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    }
    .dark .interactive-card:hover {
         box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.2);
    }

    /* --- SKELETON LOADER --- */
    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }
    .skeleton-loader {
      position: relative;
      overflow: hidden;
      background-color: #e2e8f0; /* bg-slate-200 */
    }
    .dark .skeleton-loader {
      background-color: #334155; /* dark:bg-slate-700 */
    }
    .skeleton-loader::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      transform: translateX(-100%);
      background-image: linear-gradient(
        90deg,
        rgba(255, 255, 255, 0) 0,
        rgba(255, 255, 255, 0.2) 20%,
        rgba(255, 255, 255, 0.5) 60%,
        rgba(255, 255, 255, 0)
      );
      animation: shimmer 2s infinite;
    }
    .dark .skeleton-loader::after {
      background-image: linear-gradient(
        90deg,
        rgba(0, 0, 0, 0) 0,
        rgba(0, 0, 0, 0.1) 20%,
        rgba(0, 0, 0, 0.2) 60%,
        rgba(0, 0, 0, 0)
      );
    }

    /* --- ACCESSIBILITY --- */
    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }

    /* --- ROBUST PRINTING STYLES --- */
    
    /* By default, the container holding the report is not displayed on screen */
    .print-only-container {
        display: none;
    }
    
    /* When the body has the 'is-printing' class (added via JS): */
    body.is-printing .screen-only {
        /* Hide all elements marked for screen view only */
        display: none !important;
    }

    body.is-printing .main-content-area {
        /* CRITICAL: This overrides the 'overflow: hidden' and 'overflow-y-auto' 
           on the main layout containers, which was causing the print content to be clipped. */
        overflow: visible !important;
    }
    
    body.is-printing .print-only-container {
        /* Make the print container visible */
        display: block !important;
    }

    @media print {
        /* These styles apply ONLY when the browser's print dialog is active */
        body {
            /* Reset any screen-specific body styles */
            margin: 0;
            padding: 0;
            background-color: #fff !important;
        }

        /* Hide the entire main app root, as JS will have prepared the print container */
        #root {
            display: none;
        }
        
        /* The print-only-container becomes the only visible thing */
        .print-only-container {
            display: block !important;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
        }
        
        /* Ensure reports don't have screen-specific styling like shadows or borders */
        .print-only-container .commission-report-page,
        .print-only-container .financial-report-view {
            box-shadow: none !important;
            border: none !important;
            margin: 0 !important;
            padding: 0 !important;
            max-width: 100% !important;
        }

        /* --- POS THERMAL PRINTER STYLES --- */
        /* This strategy uses a cloned element .printable-clone appended to body */
        
        /* 1. Hide everything that is NOT the clone */
        body.pos-print-mode > *:not(.printable-clone) {
            display: none !important;
        }

        /* 2. Style the clone for print */
        .printable-clone {
            display: none; /* Hidden on screen */
        }
        
        body.pos-print-mode .printable-clone {
            display: block !important;
            position: absolute !important;
            left: 0 !important;
            top: 0 !important;
            width: 100% !important;
            margin: 0 !important;
            padding: 0 !important;
            
            /* Force High Contrast & Legibility for thermal paper */
            color: black !important;
            background: white !important;
            font-size: 12px !important; 
            font-family: 'Courier New', Courier, monospace !important;
        }
        
        /* Convert dotted to dashed for better thermal rendering */
        body.pos-print-mode .printable-clone .border-gray-300,
        body.pos-print-mode .printable-clone .border-dotted {
            border-color: black !important;
            border-style: dashed !important;
            border-width: 1px !important;
        }
        
        /* High contrast for logo */
        body.pos-print-mode .printable-clone img {
            filter: grayscale(100%) contrast(150%) !important;
        }
    }

    /* --- UTILITIES --- */
    /* Hide scrollbar for Chrome, Safari and Opera */
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
    /* Hide scrollbar for IE, Edge and Firefox */
    .scrollbar-hide {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
</style>
<script type="importmap">
{
  "imports": {
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "vite": "https://aistudiocdn.com/vite@^7.2.4",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.1.1",
    "path": "https://aistudiocdn.com/path@^0.12.7",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "@supabase/supabase-js": "https://aistudiocdn.com/@supabase/supabase-js@^2.86.0"
  }
}
</script>
</head>
<body class="bg-slate-100 dark:bg-slate-900">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    <script>
        // Aggressively unregister any existing Service Workers to fix CORS/Security errors in preview
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    try {
                        registration.unregister();
                        console.log('Service Worker unregistered to fix preview errors');
                    } catch (e) {
                        // ignore errors
                    }
                }
            }).catch(function(err) {
                console.log('Service Worker unregistration check complete.');
            });
        }
    </script>
</body>
</html>
